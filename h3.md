# CNN complexity analysis

# Time/Space Complexity of MNIST CNN
For a convolutional layer with kernel size $K * K * C$, input size $C$ and output size $M$, the complexity of this layer per image is $O(W * H * K^2 * C * M)$, where $W$ and $H$ are the input image size. In particular, for `conv2` layer, we can compute the number of operations needed for a picture input from MINIST dataset. After `conv1`, the input size of `conv2` is $26 * 26$. The number of addtions and multiplications per kernel per position is $3*3 * 2 = 18$. There are $64$ kernels and $24 * 24$ positions, the total number of operations is $24 * 24 * 18 * 32 * 64 = 21233664$. As for the storage, since there are $64$ $24*24$ outputs need to be stored, the total number of parameters is $64 * 24 * 24 = 36864$. The sapce complexity in this case is approximately $O(W*H)$.

# Measured result using profiling


